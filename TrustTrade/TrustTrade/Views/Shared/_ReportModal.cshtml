<div class="modal fade" id="reportModal" tabindex="-1" aria-labelledby="reportModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="reportModalLabel">Report Content</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- Alert for spam warning -->
                <div class="alert alert-warning alert-dismissible fade show" role="alert">
                    <i class="bi bi-exclamation-triangle-fill"></i>
                    <strong>Important:</strong> False or spam reports may result in action against your account.
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>

                <!-- Report Form -->
                <form id="reportForm">
                    <input type="hidden" id="reportEntityId" />
                    <input type="hidden" id="reportType" />
                    
                    <!-- Reporter Information (Read-only) -->
                    <div class="mb-3">
                        <label class="form-label fw-bold">Your Information</label>
                        <div class="border rounded p-2 bg-light">
                            <small class="text-muted">Reporter:</small>
                            <div id="reporterInfo">Loading...</div>
                        </div>
                    </div>

                    <!-- Reported Content Information (Read-only) -->
                    <div class="mb-3">
                        <label class="form-label fw-bold">Reporting</label>
                        <div class="border rounded p-2 bg-light">
                            <div id="reportedContentInfo">Loading...</div>
                        </div>
                    </div>

                    <!-- Report Category -->
                    <div class="mb-3">
                        <label for="reportCategory" class="form-label fw-bold">Report Category <span class="text-danger">*</span></label>
                        <select class="form-select" id="reportCategory" required>
                            <option value="">Select a category...</option>
                            <option value="Spam or misleading content">Spam or misleading content</option>
                            <option value="Harassment or hate speech">Harassment or hate speech</option>
                            <option value="False information/market manipulation">False information/market manipulation</option>
                            <option value="Inappropriate content">Inappropriate content</option>
                            <option value="Impersonation">Impersonation</option>
                            <option value="Other">Other</option>
                        </select>
                        <div class="invalid-feedback">
                            Please select a report category.
                        </div>
                    </div>

                    <!-- Additional Details -->
                    <div class="mb-3">
                        <label for="reportDescription" class="form-label fw-bold">Additional Details</label>
                        <textarea class="form-control" id="reportDescription" rows="4" 
                                  placeholder="Please provide specific details about why you're reporting this content..." 
                                  maxlength="1000"></textarea>
                        <div class="form-text">
                            <span id="charCount">0</span>/1000 characters
                        </div>
                    </div>

                    <!-- Previous Reports Warning -->
                    <div id="previousReportWarning" class="alert alert-danger d-none" role="alert">
                        <i class="bi bi-exclamation-circle-fill"></i>
                        You have already reported this content. Submitting multiple reports for the same content may be considered spam and could result in action against your account.
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-danger" id="submitReportBtn">
                    <span id="submitBtnText">Submit Report</span>
                    <span id="submitBtnSpinner" class="spinner-border spinner-border-sm d-none" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </span>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Success Toast -->
<div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
    <div id="reportSuccessToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header bg-success text-white">
            <i class="bi bi-check-circle-fill me-2"></i>
            <strong class="me-auto">Report Submitted</strong>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body">
            Thank you for your report. Our team will review it shortly.
        </div>
    </div>
</div>

<style>
    #reportModal .bg-light {
        background-color: var(--bs-gray-100) !important;
    }
    
    [data-bs-theme="dark"] #reportModal .bg-light {
        background-color: var(--bs-gray-800) !important;
    }
    
    #reportModal .form-control:focus,
    #reportModal .form-select:focus {
        border-color: var(--bs-danger);
        box-shadow: 0 0 0 0.25rem rgba(220, 53, 69, 0.25);
    }
</style>